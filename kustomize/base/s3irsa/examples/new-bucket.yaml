apiVersion: dip.io/v1alpha1
kind: S3IRSA
metadata:
  name: my-app-storage
  namespace: my-app
spec:
  # Name of the ServiceAccount to bind with IAM role
  serviceAccountName: my-app-sa
  
  # Create a new S3 bucket with custom configuration
  bucketConfig:
    # Optional: specify bucket name, otherwise auto-generated
    name: my-app-data-bucket
    
    # Enable versioning for the bucket
    versioning: true
    
    # Encryption configuration
    encryption:
      enabled: true
      # Using AWS managed key (aws/s3) for cost efficiency
      # Alternatively, specify existingKmsKeyId: "arn:aws:kms:region:account:key/id"
  
  # IAM permissions
  permissions:
    allowRead: true
    allowWrite: true
    # Optional: add additional S3 actions
    additionalActions:
      - "s3:GetObjectTagging"
      - "s3:PutObjectTagging"
  
  # Tags for AWS resources
  tags:
    Application: my-app
    Environment: production
    Team: platform
